<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.expensesmanager.repository.ItemMapper">

  <select id="findByYearAndMonth" resultType="com.example.expensesmanager.entity.Item">
    SELECT id, name, cost, spent_at
    FROM items
    WHERE EXTRACT(YEAR FROM spent_at) = #{year}
    AND EXTRACT(MONTH FROM spent_at) = #{month}
    ORDER BY spent_at DESC
  </select>

  <select id="selectById" resultType="com.example.expensesmanager.entity.Item">
    SELECT id, name, cost, spent_at FROM items WHERE id = #{id};
  </select>

  <select id="insert" resultType="com.example.expensesmanager.entity.Item">
    INSERT INTO items (name, cost, spent_at)
    VALUES (#{name}, #{cost}, #{spentAt})
    RETURNING id, name, cost, spent_at
  </select>

  <update id="update">
    UPDATE items
    SET name = #{name}, cost = #{cost}, spent_at = #{spentAt}
    WHERE id = #{id}
  </update>

  <delete id="delete" parameterType="long">
    DELETE FROM items
    WHERE id = #{id}
  </delete>

</mapper>